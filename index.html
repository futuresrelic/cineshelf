<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CineShelf - Physical Media Collection Manager</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json?v=2">
    
    <!-- iOS and PWA meta tags -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="CineShelf">
    
    <!-- Icon for iOS -->
    <link rel="apple-touch-icon" href="icon-180.png">
    
    <!-- External CSS -->
    <link rel="stylesheet" href="css/styles.css">
    
    <!-- External JavaScript Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/quagga/0.12.1/quagga.min.js"></script>
</head>
<body>
    <div class="sticky-header-container">
        <div class="header">
            <h1>
                <img src="logo.png" alt="CineShelf Logo" class="header-logo" onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';">
                <span style="display: none;">üé¨</span>
                CineShelf
            </h1>
            <p style="color: rgba(255,255,255,0.8); font-size: 0.9rem;">Physical Media Collection Manager</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="App.switchTab('scan')">Scan</button>
            <button class="tab" onclick="App.switchTab('covers')">Covers</button>
            <button class="tab" onclick="App.switchTab('collection')">Movies</button>
            <button class="tab" onclick="App.switchTab('wishlist')">Wishlist</button>
            <button class="tab" onclick="App.switchTab('resolve')">Resolve</button>
            <button class="tab" onclick="App.switchTab('data')">Data</button>
            <button class="tab" onclick="App.switchTab('settings')">Settings</button>
        </div>
    </div>

    <!-- Scan Tab -->
    <div id="scan" class="tab-content active">
        <div id="status" class="status"></div>
        
        <div id="resolveNextSection" class="resolve-next-section" style="display: none;">
            <div class="resolve-next-title">üîç Resolving Unmatched Item</div>
            <div id="resolveNextInfo" class="resolve-next-info"></div>
            <div class="two-column">
                <button onclick="App.skipToNextUnresolved()" class="btn btn-secondary">Skip to Next</button>
                <button onclick="App.deleteCurrentResolveItem()" class="btn btn-danger">Delete This Item</button>
            </div>
        </div>
        
        <div id="editSection" class="resolve-next-section" style="display: none;">
            <div class="resolve-next-title">‚úèÔ∏è Editing Movie</div>
            <div id="editInfo" class="resolve-next-info"></div>
            <div class="two-column">
                <button onclick="App.saveEditChanges()" class="btn" style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%);">üíæ Save Changes</button>
                <button onclick="App.cancelEdit()" class="btn btn-secondary">Cancel Edit</button>
            </div>
        </div>
        
        <form id="movieForm">
            <div class="form-group">
                <label for="movieTitle">Movie Title *</label>
                <input type="text" id="movieTitle" required>
            </div>

            <div class="two-column">
                <button type="button" id="searchBtn" class="btn">
                    <span id="searchBtnText">üîç Search Movie Database</span>
                    <div id="searchLoader" class="loading" style="display: none;"></div>
                </button>
                <button type="button" id="imdbBtn" class="btn btn-secondary">
                    üéØ Lookup by IMDB ID
                </button>
            </div>

            <div class="form-group">
                <label for="imdbId">Or enter IMDB ID directly (e.g., tt0219965):</label>
                <input type="text" id="imdbId" placeholder="tt0123456" pattern="tt\d{7,8}">
                <small style="color: rgba(255,255,255,0.7); font-size: 0.8rem; margin-top: 0.5rem; display: block;">
                    Find the IMDB ID on the movie's IMDB page URL (starts with "tt")
                </small>
            </div>

            <div class="form-group">
                <label for="upc">UPC/Barcode</label>
                <div class="upc-input-group">
                    <input type="text" id="upc">
                    <button type="button" id="scanUpcBtn" class="scan-btn">üì∑ Scan</button>
                </div>
            </div>

            <div class="two-column">
                <div class="form-group">
                    <label for="format">Format</label>
                    <select id="format">
                        <option value="">Select Format (Optional)</option>
                        <option value="DVD">DVD</option>
                        <option value="Blu-ray">Blu-ray</option>
                        <option value="4K">4K Ultra HD</option>
                        <option value="VHS">VHS</option>
                        <option value="Digital">Digital</option>
                        <option value="Laserdisc">Laserdisc</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="region">Region</label>
                    <select id="region">
                        <option value="">Select Region</option>
                        <option value="Region 1">Region 1 (US/Canada)</option>
                        <option value="Region 2">Region 2 (Europe/Japan)</option>
                        <option value="Region 3">Region 3 (Asia)</option>
                        <option value="Region 4">Region 4 (Australia)</option>
                        <option value="Region Free">Region Free</option>
                        <option value="All Regions">All Regions</option>
                    </select>
                </div>
            </div>

            <div class="two-column">
                <div class="form-group">
                    <label for="discs">Number of Discs</label>
                    <input type="number" id="discs" min="1" value="1">
                </div>

                <div class="form-group">
                    <label for="edition">Edition</label>
                    <select id="edition">
                        <option value="">Select Edition (Optional)</option>
                    </select>
                </div>
            </div>

            <div class="form-group">
                <label for="languages">Languages/Subtitles</label>
                <input type="text" id="languages" placeholder="English, Spanish, French">
            </div>

            <div class="form-group">
                <label for="notes">Notes</label>
                <textarea id="notes" placeholder="Additional information..."></textarea>
            </div>

            <div class="two-column" id="formButtons">
                <button type="submit" name="collection" class="btn" id="addToCollectionBtn">Add to Collection</button>
                <button type="submit" name="wishlist" class="btn btn-secondary" id="addToWishlistBtn">Add to Wishlist</button>
            </div>
        </form>
        
        <script>
            // Dynamic button text based on edit mode
            document.addEventListener('DOMContentLoaded', function() {
                const updateFormButtons = () => {
                    const isEditing = window.App && window.App.getCurrentEditItem && window.App.getCurrentEditItem();
                    const collectionBtn = document.getElementById('addToCollectionBtn');
                    const wishlistBtn = document.getElementById('addToWishlistBtn');
                    
                    if (collectionBtn && wishlistBtn) {
                        if (isEditing) {
                            collectionBtn.textContent = 'üíæ Update Movie';
                            wishlistBtn.textContent = 'üìù Update & Move to Wishlist';
                        } else {
                            collectionBtn.textContent = 'Add to Collection';
                            wishlistBtn.textContent = 'Add to Wishlist';
                        }
                    }
                };
                
                // Update buttons initially and when switching tabs
                updateFormButtons();
                
                // Update buttons when form becomes visible
                const observer = new MutationObserver(updateFormButtons);
                const formButtons = document.getElementById('formButtons');
                if (formButtons) {
                    observer.observe(formButtons, { childList: true, subtree: true });
                }
            });
        </script>
    </div>

    <!-- Cover Scan Tab -->
    <div id="covers" class="tab-content">
        <div id="coverStatus" class="status"></div>
        
        <div class="api-key-section">
            <label for="apiKey">OpenAI API Key:</label>
            <input type="password" id="apiKey" placeholder="sk-..." style="margin-bottom: 0.5rem;">
            <button class="test-btn" onclick="CoverScanner.testAPI()">üîß Test API Key</button>
        </div>
        
        <div class="camera-section">
            <input type="file" id="fileInput" accept="image/*" multiple style="display: none;">
            <button onclick="document.getElementById('fileInput').click()" class="btn btn-secondary">üìÅ Upload Images</button>
            
            <div class="camera-controls">
                <button onclick="CoverScanner.startCamera()">üì∑ Start Camera</button>
                <button onclick="CoverScanner.captureImage()" id="captureBtn" disabled>üì∏ Capture</button>
                <button onclick="CoverScanner.stopCamera()">‚èπÔ∏è Stop</button>
                <button onclick="CoverScanner.clearImages()" id="clearBtn" class="clear-btn" disabled>üóëÔ∏è Clear</button>
            </div>
            
            <video id="coverVideo" autoplay></video>
            <canvas id="coverCanvas"></canvas>
            
            <div id="capturedImages" class="captured-images-container"></div>
            
            <button onclick="CoverScanner.analyzeImages()" id="analyzeBtn" class="btn" disabled>ü§ñ Extract Titles with AI</button>
        </div>
        
        <div id="coverLoading" class="loading" style="display: none;">
            Analyzing DVD covers with AI... Please wait.
        </div>
        
        <div class="titles-section">
            <h3 style="color: white; margin-bottom: 1rem;">Extracted Movie Titles:</h3>
            <div id="titlesContainer"></div>
            
            <div class="action-buttons">
                <button onclick="CoverScanner.addNewTitle()" class="btn btn-secondary">‚ûï Add Manual Title</button>
                <button onclick="CoverScanner.showList()" class="btn">üìÑ Show List</button>
            </div>
            
            <textarea id="outputArea" placeholder="Movie titles will appear here..."></textarea>
            
            <div style="text-align: center; margin-top: 0.5rem;">
                <button onclick="CoverScanner.copyText()" class="btn btn-secondary">üìã Copy to Clipboard</button>
            </div>
        </div>
    </div>

    <!-- Collection Tab -->
    <div id="collection" class="tab-content">
        <div class="view-controls">
            <div class="sort-controls" style="flex: 1; margin-bottom: 0;">
                <div class="form-group">
                    <label for="collectionSort">Sort by:</label>
                    <select id="collectionSort" onchange="App.sortMovies('collection', this.value)">
                        <option value="title">Title (A-Z)</option>
                        <option value="title-desc">Title (Z-A)</option>
                        <option value="year">Year (Oldest First)</option>
                        <option value="year-desc">Year (Newest First)</option>
                        <option value="rating">Rating (Lowest First)</option>
                        <option value="rating-desc">Rating (Highest First)</option>
                        <option value="runtime">Runtime (Shortest First)</option>
                        <option value="runtime-desc">Runtime (Longest First)</option>
                        <option value="director">Director (A-Z)</option>
                        <option value="director-desc">Director (Z-A)</option>
                        <option value="genre">Genre (A-Z)</option>
                        <option value="genre-desc">Genre (Z-A)</option>
                        <option value="format">Format (A-Z)</option>
                        <option value="format-desc">Format (Z-A)</option>
                        <option value="added">Date Added (Oldest First)</option>
                        <option value="added-desc">Date Added (Newest First)</option>
                    </select>
                </div>
            </div>
            <div class="view-toggle">
                <button class="view-btn active" onclick="App.setViewMode('collection', 'grid')" title="Grid View">‚äû</button>
                <button class="view-btn" onclick="App.setViewMode('collection', 'small')" title="Small Cards">‚ä°</button>
                <button class="view-btn" onclick="App.setViewMode('collection', 'detail')" title="Detail Cards">‚äü</button>
                <button class="view-btn" onclick="App.setViewMode('collection', 'list')" title="List View">‚ò∞</button>
            </div>
        </div>
        <div id="collectionGrid" class="movie-grid"></div>
        <div id="collectionEmpty" class="empty-state">
            <h3>No Movies in Collection</h3>
            <p>Start by scanning or adding movies to build your collection!</p>
        </div>
    </div>

    <!-- Wishlist Tab -->
    <div id="wishlist" class="tab-content">
        <div class="view-controls">
            <div class="sort-controls" style="flex: 1; margin-bottom: 0;">
                <div class="form-group">
                    <label for="wishlistSort">Sort by:</label>
                    <select id="wishlistSort" onchange="App.sortMovies('wishlist', this.value)">
                        <option value="title">Title (A-Z)</option>
                        <option value="title-desc">Title (Z-A)</option>
                        <option value="year">Year (Oldest First)</option>
                        <option value="year-desc">Year (Newest First)</option>
                        <option value="rating">Rating (Lowest First)</option>
                        <option value="rating-desc">Rating (Highest First)</option>
                        <option value="runtime">Runtime (Shortest First)</option>
                        <option value="runtime-desc">Runtime (Longest First)</option>
                        <option value="director">Director (A-Z)</option>
                        <option value="director-desc">Director (Z-A)</option>
                        <option value="genre">Genre (A-Z)</option>
                        <option value="genre-desc">Genre (Z-A)</option>
                        <option value="format">Format (A-Z)</option>
                        <option value="format-desc">Format (Z-A)</option>
                        <option value="added">Date Added (Oldest First)</option>
                        <option value="added-desc">Date Added (Newest First)</option>
                    </select>
                </div>
            </div>
            <div class="view-toggle">
                <button class="view-btn active" onclick="App.setViewMode('wishlist', 'grid')" title="Grid View">‚äû</button>
                <button class="view-btn" onclick="App.setViewMode('wishlist', 'small')" title="Small Cards">‚ä°</button>
                <button class="view-btn" onclick="App.setViewMode('wishlist', 'detail')" title="Detail Cards">‚äü</button>
                <button class="view-btn" onclick="App.setViewMode('wishlist', 'list')" title="List View">‚ò∞</button>
            </div>
        </div>
        <div id="wishlistGrid" class="movie-grid"></div>
        <div id="wishlistEmpty" class="empty-state">
            <h3>No Movies in Wishlist</h3>
            <p>Add movies you want to buy to your wishlist!</p>
        </div>
    </div>

    <!-- Resolve Tab -->
    <div id="resolve" class="tab-content">
        <div id="resolveList"></div>
        <div id="resolveEmpty" class="empty-state">
            <h3>All Movies Resolved</h3>
            <p>Great! All your movies have complete information.</p>
        </div>
    </div>

    <!-- Data Management Tab -->
    <div id="data" class="tab-content">
        <!-- User Management Section -->
        <div class="detail-section">
            <div class="detail-title">üë• User Management</div>
            <div class="form-group">
                <label for="currentUser">Current User:</label>
                <select id="currentUser" onchange="App.switchUser(this.value)">
                    <option value="default">Default User</option>
                </select>
            </div>
            <div class="form-group">
                <input type="text" id="newUserName" placeholder="New user name">
                <button onclick="App.addUser()" class="btn btn-secondary">Add User</button>
            </div>
            <button onclick="App.deleteCurrentUser()" class="btn btn-danger">Delete Current User</button>
        </div>

        <!-- Local Data Management -->
        <div class="detail-section">
            <div class="detail-title">üíæ Local Data Management</div>
            <div class="form-group">
                <button onclick="App.exportData()" class="btn">üì• Export Collection (CSV)</button>
            </div>

            <div class="form-group">
                <label for="importFile" class="file-label">üì§ Import Collection Data</label>
                <input type="file" id="importFile" class="file-input" accept=".csv,.json" onchange="App.importData(event)">
            </div>

            <div class="form-group">
                <button onclick="App.clearAllData()" class="btn btn-danger">üóëÔ∏è Clear All Data</button>
            </div>
        </div>

        <!-- Server Backup Section -->
        <div class="detail-section">
            <div class="detail-title">‚òÅÔ∏è Server Backup</div>
            <div class="form-group">
                <button onclick="App.backupToServer()" class="btn">üì§ Backup to Server</button>
            </div>
            <div class="form-group">
                <button onclick="App.restoreFromServer()" class="btn btn-secondary">üì• Restore from Server</button>
            </div>
            <div id="serverStatus" class="status" style="display: none;"></div>
            <div class="detail-text" style="font-size: 0.8rem; opacity: 0.8; margin-top: 0.5rem;">
                Note: Server backup requires server-side script setup. Data is saved as JSON files on your web server.
            </div>
        </div>

        <div class="detail-section">
            <div class="detail-title">Collection Statistics</div>
            <div id="stats" class="detail-text"></div>
        </div>
    </div>

    <!-- Settings/Admin Tab -->
    <div id="settings" class="tab-content">
        <!-- Search & Display Settings -->
        <div class="detail-section">
            <div class="detail-title">üé® Appearance & Themes</div>
            
            <div class="form-group">
                <label for="appTheme">Visual Theme:</label>
                <select id="appTheme" onchange="App.updateSetting('appTheme', this.value)">
                    <option value="cosmic">Cosmic (Default)</option>
                    <option value="dark">Dark Mode</option>
                    <option value="light">Light Mode</option>
                    <option value="ocean">Ocean Blue</option>
                    <option value="forest">Forest Green</option>
                    <option value="sunset">Sunset Orange</option>
                    <option value="royal">Royal Purple</option>
                    <option value="minimal">Minimal Gray</option>
                </select>
                <small style="color: rgba(255,255,255,0.7); font-size: 0.8rem; margin-top: 0.5rem; display: block;">
                    Choose your preferred color scheme and visual style
                </small>
            </div>

            <div class="form-group">
                <label for="compactMode">Interface Density:</label>
                <select id="compactMode" onchange="App.updateSetting('compactMode', this.value)">
                    <option value="false">Standard spacing</option>
                    <option value="true">Compact spacing</option>
                </select>
            </div>

            <div class="form-group">
                <label for="animationSpeed">Animation Speed:</label>
                <select id="animationSpeed" onchange="App.updateSetting('animationSpeed', this.value)">
                    <option value="normal">Normal speed</option>
                    <option value="fast">Fast animations</option>
                    <option value="slow">Slow animations</option>
                    <option value="none">No animations</option>
                </select>
            </div>

            <div class="form-group">
                <label for="cardStyle">Card Style:</label>
                <select id="cardStyle" onchange="App.updateSetting('cardStyle', this.value)">
                    <option value="rounded">Rounded cards</option>
                    <option value="sharp">Sharp corners</option>
                    <option value="ultra-round">Ultra rounded</option>
                    <option value="minimal">Minimal borders</option>
                </select>
            </div>
        </div>

        <!-- API Keys & Integration Settings -->
        <div class="detail-section">
            <div class="detail-title">üîë API Keys & Integration</div>
            
            <div class="form-group">
                <label for="openaiApiKey">OpenAI API Key (for Cover Scanning):</label>
                <input type="password" id="openaiApiKey" placeholder="sk-..." onchange="App.updateSetting('openaiApiKey', this.value)">
                <small style="color: rgba(255,255,255,0.7); font-size: 0.8rem; margin-top: 0.5rem; display: block;">
                    Your API key is stored locally and never shared. Get one from openai.com
                </small>
            </div>

            <div class="form-group">
                <label for="tmdbApiKey">TMDB API Key (for Movie Data):</label>
                <input type="password" id="tmdbApiKey" placeholder="Current: Built-in key" onchange="App.updateSetting('tmdbApiKey', this.value)">
                <small style="color: rgba(255,255,255,0.7); font-size: 0.8rem; margin-top: 0.5rem; display: block;">
                    Optional: Use your own TMDB API key for higher rate limits
                </small>
            </div>
        </div>

        <!-- Search & Display Settings -->
        <div class="detail-section">
            <div class="detail-title">üîç Search & Display Settings</div>
            
            <div class="form-group">
                <label for="searchResultsLimit">Movie Search Results Limit:</label>
                <select id="searchResultsLimit" onchange="App.updateSetting('searchResultsLimit', this.value)">
                    <option value="10">10 results</option>
                    <option value="15">15 results</option>
                    <option value="20">20 results</option>
                    <option value="25">25 results</option>
                    <option value="30">30 results</option>
                </select>
                <small style="color: rgba(255,255,255,0.7); font-size: 0.8rem; margin-top: 0.5rem; display: block;">
                    Number of movie suggestions shown when searching the database
                </small>
            </div>

            <div class="form-group">
                <label for="defaultViewMode">Default View Mode:</label>
                <select id="defaultViewMode" onchange="App.updateSetting('defaultViewMode', this.value)">
                    <option value="grid">Grid View</option>
                    <option value="detail">Detail Cards</option>
                    <option value="list">List View</option>
                </select>
                <small style="color: rgba(255,255,255,0.7); font-size: 0.8rem; margin-top: 0.5rem; display: block;">
                    Default view when opening Collection or Wishlist tabs
                </small>
            </div>

            <div class="form-group">
                <label for="autoResolve">Auto-resolve after scanning:</label>
                <select id="autoResolve" onchange="App.updateSetting('autoResolve', this.value)">
                    <option value="false">Manual - Always ask</option>
                    <option value="true">Auto - Search immediately</option>
                </select>
                <small style="color: rgba(255,255,255,0.7); font-size: 0.8rem; margin-top: 0.5rem; display: block;">
                    Automatically search for movie data after entering a title
                </small>
            </div>
        </div>

        <!-- Scanning Settings -->
        <div class="detail-section">
            <div class="detail-title">üì∑ Scanning Settings</div>
            
            <div class="form-group">
                <label for="barcodeBeep">Barcode Scan Sound:</label>
                <select id="barcodeBeep" onchange="App.updateSetting('barcodeBeep', this.value)">
                    <option value="true">Enabled</option>
                    <option value="false">Disabled</option>
                </select>
            </div>

            <div class="form-group">
                <label for="scannerVibration">Scanner Vibration:</label>
                <select id="scannerVibration" onchange="App.updateSetting('scannerVibration', this.value)">
                    <option value="true">Enabled</option>
                    <option value="false">Disabled</option>
                </select>
            </div>
        </div>

        <!-- Custom Editions Management -->
        <div class="detail-section">
            <div class="detail-title">üìù Custom Editions Management</div>
            
            <div class="form-group">
                <label>Current Custom Editions:</label>
                <div id="customEditionsList" style="max-height: 200px; overflow-y: auto; background: rgba(255,255,255,0.1); border-radius: 8px; padding: 1rem; margin-bottom: 1rem;">
                    <!-- Custom editions will be populated here -->
                </div>
            </div>

            <div class="form-group">
                <input type="text" id="newCustomEdition" placeholder="Add new custom edition..." maxlength="50">
                <button onclick="App.addCustomEditionFromSettings()" class="btn btn-secondary">Add Edition</button>
            </div>

            <div class="form-group" style="text-align: center;">
                <button onclick="App.resetCustomEditions()" class="btn btn-danger">Reset to Default Editions Only</button>
            </div>
            
            <small style="color: rgba(255,255,255,0.7); font-size: 0.8rem; display: block; margin-top: 0.5rem;">
                Custom editions appear in the Edition dropdown when adding movies. Default editions (Standard, Director's Cut, etc.) cannot be removed.
            </small>
        </div>

        <!-- Advanced Settings -->
        <div class="detail-section">
            <div class="detail-title">‚öôÔ∏è Advanced Settings</div>
            
            <div class="form-group">
                <label for="debugMode">Debug Mode:</label>
                <select id="debugMode" onchange="App.updateSetting('debugMode', this.value)">
                    <option value="false">Disabled</option>
                    <option value="true">Enabled</option>
                </select>
                <small style="color: rgba(255,255,255,0.7); font-size: 0.8rem; margin-top: 0.5rem; display: block;">
                    Show detailed console logs for troubleshooting
                </small>
            </div>

            <div class="form-group">
                <label for="autoBackup">Auto-backup to server:</label>
                <select id="autoBackup" onchange="App.updateSetting('autoBackup', this.value)">
                    <option value="false">Manual only</option>
                    <option value="daily">Daily</option>
                    <option value="weekly">Weekly</option>
                </select>
                <small style="color: rgba(255,255,255,0.7); font-size: 0.8rem; margin-top: 0.5rem; display: block;">
                    Automatically backup your data to server (when available)
                </small>
            </div>

            <button onclick="App.resetSettings()" class="btn btn-danger">
                üîÑ Reset All Settings to Defaults
            </button>
        </div>

        <!-- About Section -->
        <div class="detail-section">
            <div class="detail-title">‚ÑπÔ∏è About CineShelf</div>
            <div class="detail-text">
                <strong>Version:</strong> 2.1.0<br>
                <strong>Last Updated:</strong> <span id="lastUpdate">December 2024</span><br>
                <strong>Features:</strong> Movie collection management, barcode scanning, AI cover recognition, cross-device sync<br><br>
                <strong>API Integrations:</strong><br>
                ‚Ä¢ The Movie Database (TMDB) for movie information<br>
                ‚Ä¢ OpenAI GPT-4 Vision for cover image analysis<br>
                ‚Ä¢ QuaggaJS for barcode scanning<br><br>
                <strong>Data Storage:</strong> All data stored locally on your device with optional server backup
            </div>
        </div>
    </div>

    <!-- Search Results Modal -->
    <div id="searchModal" class="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="App.closeModal('searchModal')">&times;</button>
            <h3 style="color: white; margin-bottom: 1rem;">Search Results</h3>
            <div id="searchResults" class="search-results"></div>
            <button onclick="App.useWithoutData()" class="btn btn-secondary">Use Title As-Is (No Movie Data)</button>
        </div>
    </div>

    <!-- Movie Detail Modal -->
    <div id="detailModal" class="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="App.closeModal('detailModal')">&times;</button>
            <div id="movieDetail"></div>
        </div>
    </div>

    <!-- Barcode Scanner Modal -->
    <div id="scannerModal" class="scanner-modal">
        <div class="scanner-container-modal">
            <div class="scanner-header">
                <h3>üîç Scan Barcode</h3>
                <p class="scanner-hint">Position barcode within the green rectangle</p>
            </div>
            
            <div class="scanner-viewport">
                <div id="barcodeScanner"></div>
                <div class="scanner-overlay" id="scannerOverlay" style="display: none;"></div>
                <div id="scannerPlaceholder" class="scanner-placeholder">
                    <div>üì±</div>
                    <p>Camera will appear here</p>
                </div>
            </div>

            <div class="scanner-controls">
                <button class="scanner-close" onclick="BarcodeScanner.close()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- External JavaScript Modules -->
    <script src="js/app.js"></script>
    <script src="js/cover-scanner.js"></script>
    <script src="js/barcode-scanner.js"></script>
    <script src="js/service-worker.js"></script>
    
    <!-- App Initialization -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            App.init();
            CoverScanner.init();
            setTimeout(BarcodeScanner.init, 100);
        });
    </script>
</body>
</html>